<div class="search-container">
  <h1 i18n="@@search.title">Search</h1>

  <div class="search-box">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label i18n="@@search.searchLabel">Search books and authors</mat-label>
      <input
        matInput
        [formControl]="searchControl"
        i18n-placeholder="@@search.placeholder"
        placeholder="Enter search term..."
      />
      <mat-icon matPrefix>search</mat-icon>
      @if (searchControl.value) {
        <button mat-icon-button matSuffix (click)="clearSearch()">
          <mat-icon>close</mat-icon>
        </button>
      }
    </mat-form-field>
  </div>

  @if (loading()) {
    <div class="loading">
      <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
    </div>
  } @else if (hasSearched()) {
    <mat-tab-group>
      <mat-tab i18n-label="@@search.booksTab" label="Books ({{ books().length }})">
        <div class="tab-content">
          @if (books().length === 0) {
            <div class="empty-state">
              <mat-icon>library_books</mat-icon>
              <p i18n="@@books.noBooksFound">No books found</p>
            </div>
          } @else {
            <div class="results-grid">
              @for (book of books(); track book.id) {
                <mat-card>
                  <mat-card-header>
                    <mat-card-title>{{ book.title }}</mat-card-title>
                    @if (book.author) {
                      <mat-card-subtitle><span i18n="@@books.by">by</span> {{ book.author.name }}</mat-card-subtitle>
                    }
                  </mat-card-header>
                  <mat-card-content>
                    @if (book.description) {
                      <p class="description">{{ book.description }}</p>
                    }
                    @if (book.isbn) {
                      <p class="detail"><strong i18n="@@book.isbn">ISBN:</strong> {{ book.isbn }}</p>
                    }
                    @if (book.genre) {
                      <p class="detail"><strong i18n="@@book.genre">Genre:</strong> {{ book.genre }}</p>
                    }
                  </mat-card-content>
                  <mat-card-actions>
                    <a mat-button [routerLink]="['/books', book.id]">
                      <mat-icon>visibility</mat-icon>
                      <span i18n="@@search.viewDetails">View Details</span>
                    </a>
                  </mat-card-actions>
                </mat-card>
              }
            </div>
          }
        </div>
      </mat-tab>

      <mat-tab i18n-label="@@search.authorsTab" label="Authors ({{ authors().length }})">
        <div class="tab-content">
          @if (authors().length === 0) {
            <div class="empty-state">
              <mat-icon>person</mat-icon>
              <p i18n="@@authors.noAuthorsFound">No authors found</p>
            </div>
          } @else {
            <div class="results-grid">
              @for (author of authors(); track author.id) {
                <mat-card>
                  <mat-card-header>
                    <mat-card-title>{{ author.name }}</mat-card-title>
                    @if (author.nationality) {
                      <mat-card-subtitle>{{ author.nationality }}</mat-card-subtitle>
                    }
                  </mat-card-header>
                  <mat-card-content>
                    @if (author.birthDate) {
                      <p class="detail"><strong i18n="@@author.born">Born:</strong> {{ author.birthDate | date }}</p>
                    }
                    @if (author.biography) {
                      <p class="biography">{{ author.biography }}</p>
                    }
                  </mat-card-content>
                  <mat-card-actions>
                    <a mat-button [routerLink]="['/authors', author.id]">
                      <mat-icon>visibility</mat-icon>
                      <span i18n="@@search.viewDetails">View Details</span>
                    </a>
                  </mat-card-actions>
                </mat-card>
              }
            </div>
          }
        </div>
      </mat-tab>
    </mat-tab-group>
  } @else {
    <div class="empty-state">
      <mat-icon>search</mat-icon>
      <p i18n="@@search.enterSearchTerm">Enter a search term to find books and authors</p>
    </div>
  }
</div>
